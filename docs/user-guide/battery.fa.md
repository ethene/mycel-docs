# باتری و رفتار پس‌زمینه

Mycel برای رله پیام‌ها باید در پس‌زمینه اجرا شود. در اینجا آنچه باید انتظار داشته باشید و نحوه بهینه‌سازی آمده است.

## چرا عملیات پس‌زمینه مهم است

بر خلاف پیام‌رسان‌های سنتی که به اعلان‌های فشاری از سرور تکیه می‌کنند، Mycel باید:

- **به طور مداوم اسکن** کند برای دستگاه‌های نزدیک
- **اتصالات را حفظ** کند با همتایان مواجه شده
- **پیام‌ها را ذخیره و فوروارد** کند برای دیگران

اگر Mycel متوقف شود، گوشی شما از شبکه مش خارج می‌شود.

## تأثیر روی باتری

| الگوی استفاده | تأثیر روی باتری | اثربخشی رله |
|---------------|-----------------|-------------|
| برنامه در پیش‌زمینه | زیاد | بهترین |
| برنامه در پس‌زمینه (نامحدود) | متوسط | خوب |
| برنامه در پس‌زمینه (محدود) | کم | ضعیف |
| برنامه بسته شده توسط سیستم | هیچ | هیچ |

**مصرف معمول:** ۳-۸٪ باتری روزانه بسته به فعالیت و تعداد همتایان نزدیک.

## محدودیت‌های پس‌زمینه اندروید

اندروید مدرن به شدت برنامه‌های پس‌زمینه را می‌بندد. باید گوشی خود را پیکربندی کنید تا به Mycel اجازه اجرا دهد:

### ۱. غیرفعال کردن بهینه‌سازی باتری

**تنظیمات > برنامه‌ها > Mycel > باتری > نامحدود**

این به اندروید می‌گوید فعالیت پس‌زمینه Mycel را محدود نکند.

### ۲. قفل کردن برنامه (برخی گوشی‌ها)

برخی سازندگان (شیائومی، هواوی، سامسونگ) مدیریت باتری اضافی دارند:

| برند | کجا پیدا کنید |
|------|---------------|
| **شیائومی** | تنظیمات > باتری > صرفه‌جویی باتری برنامه > Mycel > بدون محدودیت |
| **هواوی** | تنظیمات > باتری > راه‌اندازی برنامه > Mycel > مدیریت دستی > فعال کردن همه |
| **سامسونگ** | تنظیمات > مراقبت از دستگاه > باتری > مدیریت مصرف برنامه > Mycel > بهینه‌سازی نشود |
| **وان‌پلاس** | تنظیمات > باتری > بهینه‌سازی باتری > Mycel > بهینه‌سازی نشود |

!!! tip "Don't Kill My App"
    به [dontkillmyapp.com](https://dontkillmyapp.com) برای دستورالعمل‌های خاص دستگاه مراجعه کنید.

### ۳. مجوز موقعیت پس‌زمینه

**تنظیمات > برنامه‌ها > Mycel > مجوزها > موقعیت > همیشه اجازه بده**

بدون این، اسکن بلوتوث وقتی گوشی را قفل می‌کنید متوقف می‌شود.

## وقتی چه اتفاقی می‌افتد...

### گوشی به خواب می‌رود

با تنظیمات صحیح، Mycel به اسکن و رله کردن ادامه می‌دهد. آیکون برنامه در نوار اعلان می‌ماند.

### حالت صرفه‌جویی باتری

بیشتر حالت‌های صرفه‌جویی باتری Mycel را محدود می‌کنند. به Mycel استثنا اضافه کنید، یا صرفه‌جویی باتری را در دوره‌های ارتباط مهم غیرفعال کنید.

### گوشی راه‌اندازی مجدد می‌شود

Mycel به طور خودکار وقتی گوشی بوت می‌شود شروع می‌شود. آیکون اعلان را خواهید دید.

### برنامه به زور متوقف می‌شود

توقف اجباری Mycel را کاملاً می‌بندد. باید برنامه را به صورت دستی باز کنید تا دوباره به مش بپیوندید.

## نکات بهینه‌سازی باتری

### اگر به حداکثر عمر باتری نیاز دارید

1. از Mycel عمدتاً وقتی نیاز دارید استفاده کنید (مواقع اضطراری، رویدادها)
2. وقتی به اتصال اینترنت برمی‌گردید برنامه را ببندید
3. شدت اسکن را در تنظیمات کاهش دهید (ویژگی آینده)

### اگر بهترین رله مش را می‌خواهید

1. Mycel را همیشه در حال اجرا نگه دارید
2. گوشی را شارژ نگه دارید یا پاوربانک داشته باشید
3. همه مجوزها را بدهید و بهینه‌سازی‌ها را غیرفعال کنید
4. از حالت صرفه‌جویی باتری استفاده نکنید

## اعلان‌ها

Mycel وقتی در پس‌زمینه اجرا می‌شود یک اعلان دائمی نشان می‌دهد:

> **Mycel در حال اجراست**
> رله مش فعال

این اعلان:

- نشان می‌دهد برنامه کار می‌کند
- از بستن برنامه توسط اندروید جلوگیری می‌کند
- وضعیت اتصال فعلی را نشان می‌دهد

می‌توانید این اعلان را کوچک کنید، اما کاملاً غیرفعال نکنید.

## عیب‌یابی

### «Mycel مدام متوقف می‌شود»

1. تنظیمات بهینه‌سازی باتری را بررسی کنید
2. تنظیمات خاص سازنده را بررسی کنید
3. Mycel را از صرفه‌جویی باتری استثنا کنید
4. از برنامه‌های «پاکسازی» یا «تقویت» که سرویس‌های پس‌زمینه را می‌بندند استفاده نکنید

### «وقتی صفحه خاموش است پیام دریافت نمی‌کنم»

1. مطمئن شوید موقعیت پس‌زمینه «همیشه اجازه بده» است
2. بررسی کنید اعلان دائمی قابل مشاهده باشد
3. تأیید کنید بهینه‌سازی باتری غیرفعال است

### «مصرف باتری زیاد»

1. این عادی است اگر همتایان نزدیک زیادی باشند
2. فاصله اسکن را کاهش دهید (ویژگی آینده)
3. فقط وقتی نیاز دارید استفاده کنید اگر باتری حیاتی است

---

**همچنین ببینید:** [مجوزها](../getting-started/permissions.md) | [نحوه تحویل](delivery.md)
